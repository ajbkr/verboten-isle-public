(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();/**
 * @preserve
 * Kontra.js v10.0.2
 */function Mt(i,t){let s=Math.sin(t),e=Math.cos(t);return{x:i.x*e-i.y*s,y:i.x*s+i.y*e}}function L(i,t,s){return Math.min(Math.max(i,s),t)}function St(i){let{x:t=0,y:s=0,width:e,height:n,radius:r}=i.world||i;return i.mapwidth&&(e=i.mapwidth,n=i.mapheight),r&&(e=r.x*2,n=r.y*2),i.anchor&&(t-=e*i.anchor.x,s-=n*i.anchor.y),e<0&&(t+=e,e*=-1),n<0&&(s+=n,n*=-1),{x:t,y:s,width:e,height:n}}let U=()=>{};function vt(i,t){let s=i.indexOf(t);if(s!=-1)return i.splice(s,1),!0}function It(i,t){let{x:s,y:e,width:n,height:r}=St(t);do s-=t.sx||0,e-=t.sy||0;while(t=t.parent);let h=i.x-Math.max(s,Math.min(i.x,s+n)),a=i.y-Math.max(e,Math.min(i.y,e+r));return h*h+a*a<i.radius*i.radius}let W={};function M(i,t){W[i]=W[i]||[],W[i].push(t)}function S(i,...t){(W[i]||[]).map(s=>s(...t))}let E,$,ft={get(i,t){return t=="_proxy"?!0:U}};function A(){return E}function y(){return $}function Ft(i,{contextless:t=!1}={}){if(E=document.getElementById(i)||i||document.querySelector("canvas"),t&&(E=E||new Proxy({},ft)),!E)throw Error("You must provide a canvas element for the game");return $=E.getContext("2d")||new Proxy({},ft),$.imageSmoothingEnabled=!1,S("init"),{canvas:E,context:$}}class j{constructor({spriteSheet:t,frames:s,frameRate:e,loop:n=!0,name:r}){let{width:h,height:a,spacing:o=0,margin:l=0}=t.frame;Object.assign(this,{spriteSheet:t,frames:s,frameRate:e,loop:n,name:r,width:h,height:a,spacing:o,margin:l,isStopped:!1,_f:0,_a:0})}clone(){return new j(this)}start(){this.isStopped=!1,this.loop||this.reset()}stop(){this.isStopped=!0}reset(){this._f=0,this._a=0}update(t=1/60){if(!this.isStopped){if(!this.loop&&this._f==this.frames.length-1){this.stop();return}for(this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}}render({x:t,y:s,width:e=this.width,height:n=this.height,context:r=y()}){let h=this.frames[this._f]/this.spriteSheet._f|0,a=this.frames[this._f]%this.spriteSheet._f|0;r.drawImage(this.spriteSheet.image,this.margin+a*this.width+(a*2+1)*this.spacing,this.margin+h*this.height+(h*2+1)*this.spacing,this.width,this.height,t,s,e,n)}}function Yt(){return new j(...arguments)}let Wt=/(jpeg|jpg|gif|png|webp)$/,$t=/(wav|mp3|ogg|aac)$/,Ut=/^\//,qt=/\/$/,Ct=new WeakMap,Gt="",Xt="",Bt="";function G(i,t){return new URL(i,t).href}function tt(i,t){return[i.replace(qt,""),t].filter(s=>s).join("/")}function et(i){return i.split(".").pop()}function it(i){let t=i.replace("."+et(i),"");return t.split("/").length==2?t.replace(Ut,""):t}function zt(i){return{wav:i.canPlayType('audio/wav; codecs="1"'),mp3:i.canPlayType("audio/mpeg;"),ogg:i.canPlayType('audio/ogg; codecs="vorbis"'),aac:i.canPlayType("audio/aac;")}}let x={},D={},b={};function st(){window.__k||(window.__k={dm:Ct,u:G,d:b,i:x})}function Nt(i){return st(),new Promise((t,s)=>{let e,n,r;if(e=tt(Gt,i),x[e])return t(x[e]);n=new Image,n.onload=function(){r=G(e,window.location.href),x[it(i)]=x[e]=x[r]=this,S("assetLoaded",this,i),t(this)},n.onerror=function(){s("Unable to load image "+e)},n.src=e})}function Kt(i){return new Promise((t,s)=>{let e=i,n,r,h,a;if(n=new Audio,r=zt(n),i=[].concat(i).reduce((o,l)=>o||(r[et(l)]?l:null),0),!i)return s("cannot play any of the audio formats provided "+e);if(h=tt(Xt,i),D[h])return t(D[h]);n.addEventListener("canplay",function(){a=G(h,window.location.href),D[it(i)]=D[h]=D[a]=this,S("assetLoaded",this,i),t(this)}),n.onerror=function(){s("Unable to load audio "+h)},n.src=h,n.load()})}function Jt(i){st();let t,s;return t=tt(Bt,i),b[t]?Promise.resolve(b[t]):fetch(t).then(e=>{if(!e.ok)throw e;return e.clone().json().catch(()=>e.text())}).then(e=>(s=G(t,window.location.href),typeof e=="object"&&Ct.set(e,s),b[it(i)]=b[t]=b[s]=e,S("assetLoaded",e,i),e))}function Qt(...i){return st(),Promise.all(i.map(t=>{let s=et([].concat(t)[0]);return s.match(Wt)?Nt(t):s.match($t)?Kt(t):Jt(t)}))}class O{constructor(t=0,s=0,e={}){t.x!=null?(this.x=t.x,this.y=t.y):(this.x=t,this.y=s),e._c&&(this.clamp(e._a,e._b,e._d,e._e),this.x=t,this.y=s)}set(t){this.x=t.x,this.y=t.y}add(t){return new O(this.x+t.x,this.y+t.y,this)}subtract(t){return new O(this.x-t.x,this.y-t.y,this)}scale(t){return new O(this.x*t,this.y*t)}normalize(t=this.length()||1){return new O(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}direction(){return Math.atan2(this.y,this.x)}clamp(t,s,e,n){this._c=!0,this._a=t,this._b=s,this._d=e,this._e=n}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?L(this._a,this._d,t):t}set y(t){this._y=this._c?L(this._b,this._e,t):t}}function N(){return new O(...arguments)}class Vt{constructor(t){return this.init(t)}init(t={}){this.position=N(),this.velocity=N(),this.acceleration=N(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let s=this.acceleration;t&&(s=s.scale(t)),this.velocity=this.velocity.add(s);let e=this.velocity;t&&(e=e.scale(t)),this.position=this.position.add(e),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}}class Tt extends Vt{init({width:t=0,height:s=0,context:e=y(),render:n=this.draw,update:r=this.advance,children:h=[],anchor:a={x:0,y:0},opacity:o=1,rotation:l=0,drotation:d=0,ddrotation:c=0,scaleX:f=1,scaleY:g=1,...u}={}){this._c=[],super.init({width:t,height:s,context:e,anchor:a,opacity:o,rotation:l,drotation:d,ddrotation:c,scaleX:f,scaleY:g,...u}),this._di=!0,this._uw(),this.addChild(h),this._rf=n,this._uf=r,M("init",()=>{this.context??(this.context=y())})}update(t){this._uf(t),this.children.map(s=>s.update&&s.update(t))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),(this.scaleX!=1||this.scaleY!=1)&&t.scale(this.scaleX,this.scaleY);let s=this.width,e=this.height;this.radius&&(s=e=this.radius*2);let n=-s*this.anchor.x,r=-e*this.anchor.y;(n||r)&&t.translate(n,r),this.context.globalAlpha=this.opacity,this._rf(),(n||r)&&t.translate(-n,-r),this.children.map(a=>a.render&&a.render()),t.restore()}draw(){}_pc(){this._uw(),this.children.map(t=>t._pc())}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:s=0,_wo:e=1,_wrot:n=0,_wsx:r=1,_wsy:h=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this.radius&&(this._wrx=this.radius,this._wry=this.radius),this._wo=e*this.opacity,this._wsx=r*this.scaleX,this._wsy=h*this.scaleY,this._wx=this._wx*r,this._wy=this._wy*h,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this.radius&&(this._wrx=this.radius*this._wsx,this._wry=this.radius*this._wsy),this._wrot=n+this.rotation;let{x:a,y:o}=Mt({x:this._wx,y:this._wy},n);this._wx=a,this._wy=o,this._wx+=t,this._wy+=s}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,radius:this.radius?{x:this._wrx,y:this._wry}:void 0,opacity:this._wo,rotation:this._wrot,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...t){t.flat().map(s=>{this.children.push(s),s.parent=this,s._pc=s._pc||U,s._pc()})}removeChild(...t){t.flat().map(s=>{vt(this.children,s)&&(s.parent=null,s._pc())})}get radius(){return this._r}set radius(t){this._r=t,this._pc()}get opacity(){return this._opa}set opacity(t){this._opa=L(0,1,t),this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}advance(t){super.advance(t),this.drotation+=this.ddrotation,this.rotation+=this.drotation}setScale(t,s=t){this.scaleX=t,this.scaleY=s}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}}class Zt extends Tt{init({image:t,width:s=t?t.width:void 0,height:e=t?t.height:void 0,...n}={}){super.init({image:t,width:s,height:e,...n})}get animations(){return this._a}set animations(t){let s,e;this._a={};for(s in t)this._a[s]=t[s].clone(),e=e||this._a[s];this.currentAnimation=e,this.width=this.width||e.width,this.height=this.height||e.height}playAnimation(t){var s;(s=this.currentAnimation)==null||s.stop(),this.currentAnimation=this.animations[t],this.currentAnimation.start()}advance(t){var s;super.advance(t),(s=this.currentAnimation)==null||s.update(t)}draw(){if(this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color){if(this.context.fillStyle=this.color,this.radius){this.context.beginPath(),this.context.arc(this.radius,this.radius,this.radius,0,Math.PI*2),this.context.fill();return}this.context.fillRect(0,0,this.width,this.height)}}}function k(){return new Zt(...arguments)}let jt=/(\d+)(\w+)/;function te(i){if(!i)return{computed:0};let t=i.match(jt),s=+t[1],e=t[2];return{size:s,unit:e,computed:s}}class ee extends Tt{init({text:t="",textAlign:s="",lineHeight:e=1,font:n=(h=>(h=y())==null?void 0:h.font)(),...r}={}){t=""+t,super.init({text:t,textAlign:s,lineHeight:e,font:n,...r}),this.context&&this._p(),M("init",()=>{this.font??(this.font=y().font),this._p()})}get width(){return this._w}set width(t){this._d=!0,this._w=t,this._fw=t}get text(){return this._t}set text(t){this._d=!0,this._t=""+t}get font(){return this._f}set font(t){this._d=!0,this._f=t,this._fs=te(t).computed}get lineHeight(){return this._lh}set lineHeight(t){this._d=!0,this._lh=t}render(){this._d&&this._p(),super.render()}_p(){this._s=[],this._d=!1;let t=this.context,s=[this.text];if(t.font=this.font,s=this.text.split(`
`),this._fw&&s.map(e=>{let n=e.split(" "),r=n.shift(),h=r;n.map(a=>{h+=" "+a,t.measureText(h).width>this._fw&&(this._s.push(r),h=a),r=h}),this._s.push(h)}),!this._s.length&&this.text.includes(`
`)){let e=0;s.map(n=>{this._s.push(n),e=Math.max(e,t.measureText(n).width)}),this._w=this._fw||e}this._s.length||(this._s.push(this.text),this._w=this._fw||t.measureText(this.text).width),this.height=this._fs+(this._s.length-1)*this._fs*this.lineHeight,this._uw()}draw(){let t=0,s=this.textAlign,e=this.context;s=this.textAlign||(e.canvas.dir=="rtl"?"right":"left"),t=s=="right"?this.width:s=="center"?this.width/2|0:0,this._s.map((n,r)=>{e.textBaseline="top",e.textAlign=s,e.fillStyle=this.color,e.font=this.font,this.strokeColor&&(e.strokeStyle=this.strokeColor,e.lineWidth=this.lineWidth??1,e.strokeText(n,t,this._fs*this.lineHeight*r)),e.fillText(n,t,this._fs*this.lineHeight*r)})}}function ie(){return new ee(...arguments)}let R=new WeakMap,ut={},nt={},bt={0:"left",1:"middle",2:"right"};function se(i){let t=i._lf.length?i._lf:i._cf;for(let s=t.length-1;s>=0;s--){let e=t[s];if(e.collidesWithPointer?e.collidesWithPointer(i):It(i,e))return e}}function _(i,t){return parseFloat(i.getPropertyValue(t))||0}function ne(i){let{canvas:t,_s:s}=i,e=t.getBoundingClientRect(),n=s.transform!="none"?s.transform.replace("matrix(","").split(","):[1,1,1,1],r=parseFloat(n[0]),h=parseFloat(n[3]),a=(_(s,"border-left-width")+_(s,"border-right-width"))*r,o=(_(s,"border-top-width")+_(s,"border-bottom-width"))*h,l=(_(s,"padding-left")+_(s,"padding-right"))*r,d=(_(s,"padding-top")+_(s,"padding-bottom"))*h;return{scaleX:(e.width-a-l)/t.width,scaleY:(e.height-o-d)/t.height,offsetX:e.left+(_(s,"border-left-width")+_(s,"padding-left"))*r,offsetY:e.top+(_(s,"border-top-width")+_(s,"padding-top"))*h}}function wt(i){let t=i.button!=null?bt[i.button]:"left";nt[t]=!0,rt(i,"onDown")}function K(i){let t=i.button!=null?bt[i.button]:"left";nt[t]=!1,rt(i,"onUp")}function gt(i){rt(i,"onOver")}function re(i){let t=R.get(i.target);t._oo=null,nt={}}function pt(i,t,s){let e=se(i);e&&e[t]&&e[t](s),ut[t]&&ut[t](s,e),t=="onOver"&&(e!=i._oo&&i._oo&&i._oo.onOut&&i._oo.onOut(s),i._oo=e)}function rt(i,t){i.preventDefault();let s=i.target,e=R.get(s),{scaleX:n,scaleY:r,offsetX:h,offsetY:a}=ne(e);i.type.includes("touch")?(Array.from(i.touches).map(({clientX:l,clientY:d,identifier:c})=>{let f=e.touches[c];f||(f=e.touches[c]={start:{x:(l-h)/n,y:(d-a)/r}},e.touches.length++),f.changed=!1}),Array.from(i.changedTouches).map(({clientX:l,clientY:d,identifier:c})=>{let f=e.touches[c];f.changed=!0,f.x=e.x=(l-h)/n,f.y=e.y=(d-a)/r,pt(e,t,i),S("touchChanged",i,e.touches),t=="onUp"&&(delete e.touches[c],e.touches.length--,e.touches.length||S("touchEnd"))})):(e.x=(i.clientX-h)/n,e.y=(i.clientY-a)/r,pt(e,t,i))}function he({radius:i=5,canvas:t=A()}={}){let s=R.get(t);if(!s){let e=window.getComputedStyle(t);s={x:0,y:0,radius:i,touches:{length:0},canvas:t,_cf:[],_lf:[],_o:[],_oo:null,_s:e},R.set(t,s)}return t.addEventListener("mousedown",wt),t.addEventListener("touchstart",wt),t.addEventListener("mouseup",K),t.addEventListener("touchend",K),t.addEventListener("touchcancel",K),t.addEventListener("blur",re),t.addEventListener("mousemove",gt),t.addEventListener("touchmove",gt),s._t||(s._t=!0,M("tick",()=>{s._lf.length=0,s._cf.map(e=>{s._lf.push(e)}),s._cf.length=0})),s}function T(...i){i.flat().map(t=>{let s=t.context?t.context.canvas:A(),e=R.get(s);if(!e)throw new ReferenceError("Pointer events not initialized for the objects canvas");t.__r||(t.__r=t.render,t.render=function(){e._cf.push(this),this.__r()},e._o.push(t))})}function ae(i){let t=i.canvas;i.clearRect(0,0,t.width,t.height)}function oe({fps:i=60,clearCanvas:t=!0,update:s=U,render:e,context:n=y(),blur:r=!1}={}){if(!e)throw Error("You must provide a render() function");let h=0,a=1e3/i,o=1/i,l=t?ae:U,d,c,f,g,u,w=!0;r||(window.addEventListener("focus",()=>{w=!0}),window.addEventListener("blur",()=>{w=!1})),M("init",()=>{u.context??(u.context=y())});function p(){if(c=requestAnimationFrame(p),!!w&&(f=performance.now(),g=f-d,d=f,!(g>1e3))){for(h+=g;h>=a;)S("tick"),u.update(o),h-=a;l(u.context),u.render()}}return u={update:s,render:e,isStopped:!0,context:n,start(){this.isStopped&&(d=performance.now(),this.isStopped=!1,requestAnimationFrame(p))},stop(){this.isStopped=!0,cancelAnimationFrame(c)},_frame:p,set _last(m){d=m}},u}function le(i){if(+i==i)return i;let t=[],s=i.split(".."),e=+s[0],n=+s[1],r=e;if(e<n)for(;r<=n;r++)t.push(r);else for(;r>=n;r--)t.push(r);return t}class de{constructor({image:t,frameWidth:s,frameHeight:e,spacing:n=0,margin:r=0,animations:h}={}){if(!t)throw Error("You must provide an Image for the SpriteSheet");this.animations={},this.image=t,this.frame={width:s,height:e,spacing:n,margin:r},this._f=(t.width-r)/s|0,this.createAnimations(h)}createAnimations(t){let s,e;for(e in t){let{frames:n,frameRate:r,loop:h}=t[e];if(s=[],n==null)throw Error("Animation "+e+" must provide a frames property");[].concat(n).map(a=>{s=s.concat(le(a))}),this.animations[e]=Yt({spriteSheet:this,frames:s,frameRate:r,loop:h,name:e})}}}function ce(){return new de(...arguments)}let fe=2147483648,ue=1073741824,_t=536870912;function H(i,t){return i/t|0}function P(i,t){return i/t|0}class we{constructor(t={}){let{width:s,height:e,tilewidth:n,tileheight:r,tilesets:h}=t,a=s*n,o=e*r,l=document.createElement("canvas");l.width=a,l.height=o,this._c=l,this._ctx=l.getContext("2d"),h.map(d=>{let{__k:c,location:f}=window,g=(c?c.dm.get(t):"")||f.href,{source:u}=d;if(u){if(!c)throw Error('You must use "load" or "loadData" to resolve tileset.source');let p=c.d[c.u(u,g)];if(!p)throw Error(`You must load the tileset source "${u}" before loading the tileset`);Object.keys(p).map(m=>{d[m]=p[m]})}let{image:w}=d;if(""+w===w){if(!c)throw Error('You must use "load" or "loadImage" to resolve tileset.image');let p=c.i[c.u(w,g)];if(!p)throw Error(`You must load the image "${w}" before loading the tileset`);d.image=p}}),Object.assign(this,{context:y(),layerMap:{},layerCanvases:{},mapwidth:a,mapheight:o,_sx:0,_sy:0,_o:[],...t}),this.context&&this._p(),M("init",()=>{this.context??(this.context=y()),this._p()})}get sx(){return this._sx}get sy(){return this._sy}set sx(t){let s=Math.max(0,this.mapwidth-A().width);this._sx=L(0,s,t)}set sy(t){let s=Math.max(0,this.mapheight-A().height);this._sy=L(0,s,t)}set objects(t){this.remove(this._o),this.add(t)}get objects(){return this._o}add(...t){t.flat().map(s=>{this._o.push(s),s.parent=this})}remove(...t){t.flat().map(s=>{vt(this._o,s),s.parent=null})}getPosition(t){let s=A().getBoundingClientRect(),e=t.x-s.x,n=t.y-s.y;return e+=this.sx,n+=this.sy,{x:e,y:n,row:H(n,this.tileheight),col:P(e,this.tilewidth)}}setTileAtLayer(t,s,e){let{layerMap:n,tileheight:r,tilewidth:h,width:a}=this,{row:o,col:l,x:d,y:c}=s,f=o??H(c,r),g=l??P(d,h);n[t]&&(this._d=!0,n[t]._d=!0,n[t].data[f*a+g]=e)}setLayer(t,s){let{layerMap:e}=this;e[t]&&(this._d=!0,e[t]._d=!0,e[t].data=s)}layerCollidesWith(t,s){let{tilewidth:e,tileheight:n,layerMap:r}=this,{x:h,y:a,width:o,height:l}=St(s),d=H(a,n),c=P(h,e),f=H(a+l,n),g=P(h+o,e),u=r[t];for(let w=d;w<=f;w++)for(let p=c;p<=g;p++)if(u.data[p+w*this.width])return!0;return!1}tileAtLayer(t,s){let{layerMap:e,tileheight:n,tilewidth:r,width:h}=this,{row:a,col:o,x:l,y:d}=s,c=a??H(d,n),f=o??P(l,r);return e[t]?e[t].data[c*h+f]:-1}render(t=this._c,s=!0){let{_d:e,context:n,sx:r=0,sy:h=0}=this;e&&this._p();let{width:a,height:o}=A(),l=Math.min(t.width,a),d=Math.min(t.height,o);n.drawImage(t,r,h,l,d,0,0,l,d),s&&(n.save(),(r||h)&&n.translate(-r,-h),this.objects.map(c=>c.render&&c.render()),n.restore())}renderLayer(t){let{layerCanvases:s,layerMap:e}=this,n=e[t],r=s[t],h=r==null?void 0:r.getContext("2d");if(!r){let{mapwidth:a,mapheight:o}=this;r=document.createElement("canvas"),h=r.getContext("2d"),r.width=a,r.height=o,s[t]=r,this._rl(n,h)}n._d&&(n._d=!1,h.clearRect(0,0,r.width,r.height),this._rl(n,h)),this.render(r,!1)}_p(){let{_ctx:t,layers:s=[],layerMap:e}=this;this._d=!1,s.map(n=>{let{name:r,data:h,visible:a}=n;n._d=!1,e[r]=n,h&&a!=!1&&this._rl(n,t)})}_rl(t,s){let{opacity:e,data:n=[]}=t,{tilesets:r,width:h,tilewidth:a,tileheight:o}=this;s.save(),s.globalAlpha=e,n.map((l,d)=>{if(!l)return;let c=0,f=0,g=l&fe,u=l&ue,w=0,p=0,m=0,I=0,at=0;c=g||u,l&=1073741823,at=l&_t,at&&(g&&u?m=1:g?w=1:u?p=1:I=1,f=w||p||m||I,l&=~_t);let X;for(let z=r.length-1;z>=0&&(X=r[z],!(l/X.firstgid>=1));z--);let{image:ot,spacing:B=0,margin:lt=0,firstgid:Ht,columns:Pt}=X,dt=l-Ht,ct=Pt??ot.width/(a+B)|0,v=d%h*a,C=(d/h|0)*o,Lt=lt+dt%ct*(a+B),Rt=lt+(dt/ct|0)*(o+B);f?(s.save(),s.translate(v+a/2,C+o/2),p||I?s.rotate(-Math.PI/2):(w||m)&&s.rotate(Math.PI/2),(m||I)&&s.scale(-1,1),v=-a/2,C=-o/2):c&&(s.save(),s.translate(v+(g?a:0),C+(u?o:0)),s.scale(g?-1:1,u?-1:1),v=c?0:v,C=c?0:C),s.drawImage(ot,Lt,Rt,a,o,v,C,a,o),(c||f)&&s.restore()}),s.restore()}}function ge(){return new we(...arguments)}const At="assets/",Ot=`${At}assets/spritesheet.png`,kt=`${At}assets/tilesheet.png`,pe=[Ot,kt],_e=i=>Qt(...pe),q=640,ht=320,me=32,ye=32,F=24,Y=24,xe="aqua",Dt=[{id:1,name:"Fools' Landing",flooded:!1},{id:2,name:"Cave of Shadows",flooded:!1},{id:3,name:"Temple of the Moon",flooded:!1},{id:4,name:"Copper Gate",flooded:!1},{id:5,name:"Whispering Garden",flooded:!1},{id:6,name:"Dunes of Deception",flooded:!1},{id:7,name:"Silver Gate",flooded:!1},{id:8,name:"Observatory",flooded:!1},{id:9,name:"Breakers Bridge",flooded:!1},{id:10,name:"Twilight Hollow",flooded:!1},{id:11,name:"Lost Lagoon",flooded:!1},{id:12,name:"Bronze Gate",flooded:!1},{id:13,name:"Phantom Rock",flooded:!1},{id:14,name:"Watchtower",flooded:!1},{id:15,name:"Cliffs of Abandon",flooded:!1},{id:16,name:"Misty Marsh",flooded:!1},{id:17,name:"Coral Palace",flooded:!1},{id:18,name:"Howling Garden",flooded:!1},{id:19,name:"Iron Gate",flooded:!1},{id:20,name:"Gold Gate",flooded:!1},{id:21,name:"Crimson Forest",flooded:!1},{id:22,name:"Temple of the Sun",flooded:!1},{id:23,name:"Cave of Embers",flooded:!1},{id:24,name:"Tidal Palace",flooded:!1}];function Ee(){const i=ce({image:x[Ot],frameWidth:32,frameHeight:32,animations:Dt.map((s,e)=>({[e]:{frames:e,frameRate:1}})).reduce((s,e)=>({...s,...e}))}),t=[];for(let s=0;s<Object.keys(i.animations).length;++s){const e=k({x:s*32,y:0,animations:i.animations,id:1+s});e.playAnimation(s),t.push(e)}return t}async function Se(){try{const i=x[kt];return ge({tilewidth:32,tileheight:32,width:8,height:8,tilesets:[{firstgid:0,image:i}],layers:[{name:"ground",data:[0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0]}]})}catch(i){return console.error(i),null}}const ve=1,Ce=2,Te=3,be=4;function Ae(){const i=k({color:"brown",width:F,height:Y,id:ve}),t=k({color:"yellow",width:F,height:Y,id:Ce}),s=k({color:"red",width:F,height:Y,id:Te}),e=k({color:"blue",width:F,height:Y,id:be});return{theCrystalOfFire:s,theEarthStone:i,theOceansChalice:e,theStatueOfTheWind:t}}function Oe(){return k({x:0,y:0,color:xe,width:q,height:ht})}function ke(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var J={exports:{}},Q,mt;function De(){return mt||(mt=1,Q=function(i,t){this.reset=function(){this.cards=i.slice(0),this.length=this.cards.length},this.shuffle=function(){s(this.cards)},this.reset(),this.shuffle(),this.deal=function(e,n){for(var r=0;r<e;r++)for(var h=0;h<n.length;h++){if(!n[h]||!n[h].push)throw new Error("Deck#deal | Undefined Hand");n[h].push(this.cards.pop())}this.length=this.cards.length},this.draw=function(e){if(!e||e<=1)return this.length=this.cards.length-1,this.cards.pop();for(var n=[],r=0;r<e;r++)n.push(this.cards.pop());return this.length=this.cards.length,n},this.drawFromBottomOfDeck=function(e){(!e||e<1)&&(e=1);for(var n=[],r=0;r<e;r++)n.push(this.cards.shift());return this.length=this.cards.length,n.length===1?n[0]:n},this.drawRandom=function(e){var n=function(){var a=Math.floor(t()*this.cards.length),o=this.cards[a];return this.cards.splice(a,1),this.length=this.cards.length,o};if(!e||e<=1)return n.apply(this);for(var r=[],h=0;h<e;h++)r.push(n.apply(this));return r},this.putOnTopOfDeck=function(e){if(!e instanceof Array)this.cards.push(e);else for(var n=0;n<e.length;n++)this.cards.push(e[n]);this.length=this.cards.length},this.putOnBottomOfDeck=function(e){if(!e instanceof Array)this.cards.unshift(e);else for(var n=0;n<e.length;n++)this.cards.unshift(e[n]);this.length=this.cards.length};function s(e){var n=e.length;if(n===0)return!1;for(;--n;){var r=Math.floor(t()*(n+1)),h=e[n],a=e[r];e[n]=a,e[r]=h}}}),Q}var V,yt;function He(){return yt||(yt=1,V=function(i,t,s){this.suit=i,this.description=t,this.sort=s,this.toString=function(){return this.description+" of "+this.suit+"s"},this.toShortDisplayString=function(){var e=this.suit.substring(0,1),n;switch(this.sort){case 11:n="J";break;case 12:n="Q";break;case 13:n="K";break;case 14:n="A";break;default:n=this.sort}return n+e}}),V}var Z,xt;function Pe(){if(xt)return Z;xt=1;var i=He();return Z=function(){this.cards=[new i("Club","Two",2),new i("Club","Three",3),new i("Club","Four",4),new i("Club","Five",5),new i("Club","Six",6),new i("Club","Seven",7),new i("Club","Eight",8),new i("Club","Nine",9),new i("Club","Ten",10),new i("Club","Jack",11),new i("Club","Queen",12),new i("Club","King",13),new i("Club","Ace",14),new i("Diamond","Two",2),new i("Diamond","Three",3),new i("Diamond","Four",4),new i("Diamond","Five",5),new i("Diamond","Six",6),new i("Diamond","Seven",7),new i("Diamond","Eight",8),new i("Diamond","Nine",9),new i("Diamond","Ten",10),new i("Diamond","Jack",11),new i("Diamond","Queen",12),new i("Diamond","King",13),new i("Diamond","Ace",14),new i("Heart","Two",2),new i("Heart","Three",3),new i("Heart","Four",4),new i("Heart","Five",5),new i("Heart","Six",6),new i("Heart","Seven",7),new i("Heart","Eight",8),new i("Heart","Nine",9),new i("Heart","Ten",10),new i("Heart","Jack",11),new i("Heart","Queen",12),new i("Heart","King",13),new i("Heart","Ace",14),new i("Spade","Two",2),new i("Spade","Three",3),new i("Spade","Four",4),new i("Spade","Five",5),new i("Spade","Six",6),new i("Spade","Seven",7),new i("Spade","Eight",8),new i("Spade","Nine",9),new i("Spade","Ten",10),new i("Spade","Jack",11),new i("Spade","Queen",12),new i("Spade","King",13),new i("Spade","Ace",14)]},Z}var Et;function Le(){if(Et)return J.exports;Et=1;var i=De(),t=Pe(),s=J.exports={},e={deck:new t().cards,numberOfDecks:1,random:function(){return Math.random()}};return s.playingCards=function(){return new t().cards},s.shuffle=function(n){if(n||(n=e),n.deck||(n.deck=e.deck),n.numberOfDecks)for(var r=n.deck,h=0;h<n.numberOfDecks-1;h++)n.deck=n.deck.concat(r);return n.random||(n.random=e.random),new i(n.deck,n.random)},J.exports}var Re=Le();const Me=ke(Re),Ie=Me.shuffle({deck:Dt});function Fe(i){return function(){const{innerWidth:t,innerHeight:s}=window,e=t/s,n=q/ht;e<n?(i.style.width=`${t}px`,i.style.height=`${t/n}px`):(i.style.width=`${s*n}px`,i.style.height=`${s}px`)}}async function Ye(){const{canvas:i}=Ft();i.width=q,i.height=ht;const t=Fe(i);t(),window.addEventListener("resize",t),he();const s=ie({font:"32px Arial",color:"blue",x:q/2-me,y:ye});await _e();const e=await Se();if(e===null)return 1;const n=Oe();n.onDown=n.onOver=()=>{s.text=""},T(n);const r=Ee(),h=e.layers.find(({name:f})=>f==="ground");if(h!==void 0){for(let f=0;f<e.height;++f)for(let g=0;g<e.width;++g)if(h.data[f*e.width+g]!==0){const u=Ie.draw(),w=r[u.id-1];w.x=g*w.width,w.y=f*w.height,w.onDown=w.onOver=()=>{s.text=u.name},T(w),e.add(w)}}const{theCrystalOfFire:a,theEarthStone:o,theOceansChalice:l,theStatueOfTheWind:d}=Ae();return o.x=r[0].width+(r[0].width-o.width)/2,o.y=r[0].height+(r[0].height-o.height)/2,o.onDown=o.onOver=()=>{s.text="The Earth Stone"},T(o),e.add(o),d.x=r[0].width+(r[0].width-d.width)/2,d.y=r[0].height*6+(r[0].height-d.height)/2,d.onDown=d.onOver=()=>{s.text="The Statue of the Wind"},T(d),e.add(d),a.x=r[0].width*6+(r[0].width-a.width)/2,a.y=r[0].height+(r[0].height-a.height)/2,a.onDown=a.onOver=()=>{s.text="The Crystal of Fire"},T(a),e.add(a),l.x=r[0].width*6+(r[0].width-l.width)/2,l.y=r[0].height*6+(r[0].height-l.height)/2,l.onDown=l.onOver=()=>{s.text="The Ocean's Chalice"},T(l),e.add(l),oe({render(){n.render(),e.render(),s.render()},update(){}}).start(),0}Ye();
